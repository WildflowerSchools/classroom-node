---
apiVersion: apps/v1
kind: DaemonSet
metadata:
  namespace: classroom
  name: echo-collector
  labels:
    name: echo-collector
spec:
  selector:
    matchLabels:
      name: echo-collector
  template:
    metadata:
      namespace: classroom
      labels:
        name: echo-collector
    spec:
      hostNetwork: true
      nodeSelector:
        wildflower-type: camera
      containers:
      - image: "optimuspaul/underground-cavern:echo-v1"
        name: echo-collector
        securityContext:
          privileged: true
        ports:
        - containerPort: 8000
        volumeMounts:
        - name: data
          mountPath: /data
        - name: dev
          mountPath: /dev
        - name: config-volume
          mountPath: /app/macs.txt
          subPath: macs
      volumes:
        - name: data
          hostPath:
            path: /usr/lib/wildflower/
            type: Directory
        - name: dev
          hostPath:
            path: /dev
            type: Directory
        - name: config-volume
          configMap:
            name: echoes-config


---
apiVersion: v1
data:
  macs: |
    e8:f5:88:e4:80:ab
    ed:1b:07:0f:2d:5f
    c0:ed:12:ae:fe:72
    d8:4c:3c:d0:73:5f
    df:bd:99:89:30:d8
    d2:8c:28:c9:0a:bc
    ea:8d:a1:97:3a:93
    f1:41:fd:02:85:b4
    f7:37:32:af:e0:45
    de:d5:97:f9:0e:92
    cc:05:d5:41:6e:0b
    cc:df:e6:16:75:d5
kind: ConfigMap
metadata:
  name: echoes-config
  namespace: classroom

